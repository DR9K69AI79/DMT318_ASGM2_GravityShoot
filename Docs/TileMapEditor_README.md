# Tile Map Editor - 3D地图编辑器工具

这是一个专为Unity设计的强大3D tile地图编辑器，特别适用于使用KayKit太空基地模型包构建游戏关卡。

## 🚀 功能特色

### 核心编辑功能
- **网格对齐放置** - 自动对齐到网格，确保完美拼接
- **智能分类** - 自动将模型按功能分类（地形、建筑、装饰等）
- **实时预览** - 鼠标悬停时显示半透明预览
- **多种编辑模式** - 放置、删除、选择、绘制模式
- **撤销/重做** - 完整的撤销系统支持

### 地形生成工具
- **基础平台生成** - 快速创建各种尺寸的平台
- **环形地形** - 自动生成环形结构
- **智能路径** - 两点间自动生成连接路径
- **地形模板** - 预设常用地形布局

### 批量操作
- **智能排列** - 直线、网格、圆形排列
- **批量替换** - 一键替换选中对象
- **随机旋转** - 增加场景自然感
- **网格对齐** - 批量对齐到网格

### 优化工具
- **网格合并** - 优化渲染性能
- **LOD生成** - 自动生成细节层次
- **重复检测** - 查找并处理重复对象
- **空对象清理** - 清理无用的空GameObject

## 📦 安装与设置

1. 将以下脚本文件放入 `Assets/Scripts/Editor/` 文件夹：
   - `TileMapEditor.cs`
   - `TileMapEditorExtensions.cs`
   - `TileMapQuickTools.cs`

2. 确保你的KayKit模型包位于 `Assets/Art/KayKit/KayKit_SpaceBase/`

3. 重新编译Unity脚本

## 🎯 使用指南

### 开启编辑器
1. 在Unity顶部菜单选择 `Tools > Tile Map Editor`
2. 可选择同时打开 `Tools > Tile Map Quick Tools` 获得更多功能

### 基础操作

#### 1. 选择Prefab
- 左侧面板会自动显示分类后的所有可用模型
- 点击预览图标选择要放置的模型
- 支持按类别浏览：🌍地形、🏢建筑、🚇隧道等

#### 2. 编辑模式
- **放置模式 (1键)** - 点击场景放置选中的模型
- **删除模式 (2键)** - 点击删除已有对象
- **选择模式 (3键)** - 正常选择对象
- **绘制模式 (4键)** - 按住Shift连续放置

#### 3. Scene视图快捷键
- **R键** - 快速旋转90度
- **G键** - 切换网格显示
- **Esc键** - 取消当前选择
- **右键** - 显示上下文菜单

### 高级功能

#### 地形生成
1. 打开Quick Tools窗口
2. 在"🌍 地形生成"面板：
   - **基础平台**：设置中心点和尺寸，一键生成平台
   - **环形地形**：设置内外半径，生成环形结构
   - **连接路径**：设置起终点，自动生成路径

#### 批量操作
1. 选择多个对象
2. 在Quick Tools窗口使用"⚡ 批量操作"：
   - **随机旋转**：增加场景自然感
   - **智能排列**：整齐排列选中对象
   - **批量替换**：统一替换为新模型

#### 地图保存/加载
1. 在主编辑器窗口设置地图名称
2. 点击"保存"将当前地图保存为JSON文件
3. 点击"加载"恢复之前保存的地图

## 🔧 配置选项

### 网格设置
- **网格大小**：默认2单位，可根据模型调整
- **网格对齐**：开启后所有对象自动对齐网格
- **显示网格**：在Scene视图显示辅助网格线

### 编辑器设置
- **显示名称**：在预览列表显示模型名称
- **调试信息**：显示额外的调试信息
- **图标大小**：调整预览图标尺寸

## 🎨 工作流程建议

### 1. 规划阶段
- 使用纸笔或数字工具先设计大致布局
- 确定主要区域：基地核心、工业区、停机坪等

### 2. 基础建设
- 使用地形生成工具创建基础平台
- 先铺设主要的地形结构

### 3. 建筑布局
- 放置主要建筑模块
- 使用智能排列功能整理布局

### 4. 细节装饰
- 添加货物、设备等装饰物
- 使用随机旋转增加自然感

### 5. 优化完善
- 运行地图验证检查问题
- 使用网格合并优化性能
- 生成LOD提升帧率

## 🛠️ 故障排除

### 常见问题

**Q: 无法找到模型**
A: 检查模型路径是否为 `Assets/Art/KayKit/KayKit_SpaceBase/`

**Q: 预览不显示**
A: 等待Unity生成预览图，或重启编辑器窗口

**Q: 网格对齐不准确**
A: 调整网格大小以匹配你的模型尺寸

**Q: 性能问题**
A: 使用网格合并工具优化渲染，限制单屏幕可见对象数量

### 性能优化建议
1. 定期合并静态网格
2. 为远距离对象生成LOD
3. 使用遮挡剔除
4. 合理规划光照烘焙

## 🔄 更新日志

### v1.0
- 基础编辑功能
- 自动分类系统
- 地形生成工具
- 批量操作
- 地图保存/加载

## 🤝 贡献与支持

如果你发现bug或有改进建议：
1. 在Unity控制台查看错误信息
2. 检查模型文件完整性
3. 验证脚本放置位置正确

## 📝 许可证

此工具为教育项目使用，请遵循Unity和KayKit的相关许可协议。

---

**提示**：首次使用建议在空场景中测试功能，熟悉操作后再在正式项目中使用。
